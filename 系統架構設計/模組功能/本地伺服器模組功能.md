本地伺服器模組功能
---

#### 功能概述
1. 通訊轉接模組註冊及解除。
2. 經由網路接收用戶控制指令, 轉發到各通訊轉接模組。
3. 儲存各設備最新狀態, 轉發到連線用戶設備上。
4. 用戶可自定警示條件 (數值範圍及持續時間), 達到條件可經由訊息通知。
5. 情境、智慧控制或排程控管。
6. 日誌記錄: 分一般及警示。
7. 其他服務: 天氣查詢 ...
8. 監控管理伺服器。
9. App 初始化連線, QR-Code 下載設定等處理。
10. MQ 管理
11. 通訊轉接模組自動偵測是否離線，超過指定時間則移除並通知管理者。
12. 管理日誌、通訊轉接模組手動新增/移除、其他服務 ...

#### 預估模組
1. 路由模組 (接收 Public Queue)：
    * 檢查訊息合法性。
    * 記錄該模組／設備最新狀態值及時間戳記。
    * 若為 Server 為本地，則丟往管理模組。
    * 若為狀態回應訊息，則將 Server 標記為本地伺服器 ID 再轉丟向雲端伺服器。
2. 管理模組：
    * 檢查登入授權合法性，回應訊息。
    * 接收用戶控制命令，轉送到指定 Queue ID。
    * 若模組/設備/狀態需統計儲存，則轉交資料統計模組進一步處理。
    * 模組/設備/狀態異常及關注處理: 若達到觸發條件時轉訊息通知模組處理。
3. 資料統計模組: (是否限雲端伺服器才有?)
    * 儲存模組/設備/狀態+時間。
    * 是否轉區間值 (小時、日、週、月)、如何轉換該值 (平均值:温度、最終值:電表、與前筆之差:電表)、及何時轉換/統計?
    * 排程轉換資料時區?
    * 資料保存在那裡? 保存多久?
4. 訊息通知模組:
    * 根據設定檔轉發通知訊息，如: 發 email、簡訊、Android 推播、iOS 推播、自行推播...。
    * 記錄通知回應狀態 (是否成功)。
    * 連續或超過指定時間仍無法轉送訊息，則發出系統警告 (email、訊息通知系統管理者)。
5. Web 模組:
    * 情境、智慧控制或排程設計，QR-Code 下載設定。
    * 模組/設備的管理，手動移除不用的模組/設備。
    * MQ 管理 (帳號及 Queue)。
    * 用戶帳號 (是否允許多組?)。
    * 相關資料及設定檔備份及還原管理。
    * 日誌管理。

#### 情境、智慧控制、排程
1. 情境: 選取多項可輸出控制的功能。
2. 智慧控制: 設定狀態及下一行為，每一狀態行為如下
    * 輸入狀態滿足條件並持續一段時間。
    * 執行某功能控制輸出或情境。
    * 延遲一段時間。
    * 進入下一狀態或結束。
    * 中止條件: 全局或僅限目前狀態?
3. 排程設計:
    * 指定日期範圍 (下列時間點重複執行)。
    * 時間點: 每月x日、週日~週六 (複選)，幾點幾分/間隔時間。
    * 執行輸出控制功能、情境、智慧控制。
